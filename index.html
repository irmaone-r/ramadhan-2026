<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khatam Hub - Rika & Azka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #10b981; border-radius: 10px; }
        @keyframes pulse-soft { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .animate-pulse-soft { animation: pulse-soft 3s infinite; }
    </style>
</head>
<body class="bg-[#F8FAFC] text-slate-800 pb-24">

    <!-- Top Navigation / Header -->
    <header class="bg-emerald-800 text-white p-6 rounded-b-[2.5rem] shadow-2xl sticky top-0 z-50">
        <div class="max-w-md mx-auto">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h1 class="text-2xl font-black flex items-center gap-2 tracking-tighter">
                        <i data-lucide="moon" class="w-7 h-7 text-yellow-300 fill-current"></i> KHATAM HUB
                    </h1>
                    <p class="text-[10px] opacity-70 font-bold uppercase tracking-[0.2em] mt-1 flex items-center gap-1">
                        <i data-lucide="map-pin" class="w-3 h-3 text-emerald-400"></i> JKT <span class="text-emerald-400">â†”</span> BKL
                    </p>
                </div>
                <div id="countdown" class="flex gap-2 font-bold">
                    <!-- Countdown injected here -->
                </div>
            </div>
            
            <!-- Daily Quote -->
            <div class="bg-emerald-900/50 rounded-2xl p-3 border border-emerald-700/50 flex items-center gap-3">
                <div class="bg-emerald-500/20 p-2 rounded-xl">
                    <i data-lucide="sparkles" class="w-4 h-4 text-emerald-300"></i>
                </div>
                <p id="daily-quote" class="text-[11px] italic font-medium opacity-90 leading-tight">
                    "Sebaik-baik kalian adalah yang mempelajari Al-Qur'an dan mengajarkannya."
                </p>
            </div>
        </div>
    </header>

    <main class="max-w-md mx-auto p-4 space-y-6">
        
        <!-- Stats Comparison Card -->
        <section class="bg-white p-6 rounded-[2.5rem] shadow-sm border border-slate-100 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4 opacity-5">
                <i data-lucide="book-open" class="w-24 h-24"></i>
            </div>
            
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-[11px] font-black uppercase text-slate-400 tracking-widest flex items-center gap-2">
                    <i data-lucide="activity" class="w-4 h-4 text-emerald-500"></i> Battle Progress
                </h3>
                <span id="day-badge" class="bg-emerald-50 text-emerald-700 text-[10px] font-black px-3 py-1 rounded-full border border-emerald-100 uppercase animate-pulse-soft">
                    Ramadhan Day 1
                </span>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <!-- Rika Column -->
                <div class="space-y-3 bg-emerald-50/30 p-4 rounded-3xl border border-emerald-100">
                    <div class="flex justify-between items-center">
                        <span class="text-[10px] font-black text-emerald-800 opacity-60">RIKA</span>
                        <i data-lucide="heart" class="w-3 h-3 text-emerald-500 fill-current"></i>
                    </div>
                    <div class="text-center py-2">
                        <span id="rika-count" class="text-4xl font-black text-emerald-600">0</span>
                        <span class="text-xs text-emerald-300 font-bold">/30</span>
                    </div>
                    <div class="h-1.5 bg-emerald-100 rounded-full overflow-hidden">
                        <div id="rika-bar" class="h-full bg-emerald-500 transition-all duration-1000 w-0"></div>
                    </div>
                </div>

                <!-- Azka Column -->
                <div class="space-y-3 bg-blue-50/30 p-4 rounded-3xl border border-blue-100">
                    <div class="flex justify-between items-center">
                        <span class="text-[10px] font-black text-blue-800 opacity-60">AZKA</span>
                        <i data-lucide="zap" class="w-3 h-3 text-blue-500 fill-current"></i>
                    </div>
                    <div class="text-center py-2">
                        <span id="azka-count" class="text-4xl font-black text-blue-600">0</span>
                        <span class="text-xs text-blue-300 font-bold">/30</span>
                    </div>
                    <div class="h-1.5 bg-blue-100 rounded-full overflow-hidden">
                        <div id="azka-bar" class="h-full bg-blue-500 transition-all duration-1000 w-0"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dynamic Message -->
        <div id="status-alert" class="bg-slate-900 text-white p-5 rounded-[2rem] flex items-center gap-4 border-b-4 border-emerald-500 shadow-xl">
            <div class="bg-emerald-500/20 p-3 rounded-2xl">
                <i data-lucide="message-circle" class="w-6 h-6 text-emerald-400"></i>
            </div>
            <div>
                <h4 id="status-title" class="text-[10px] font-black text-emerald-400 uppercase tracking-widest mb-0.5">Status Persaingan</h4>
                <p id="status-desc" class="text-xs font-semibold opacity-90 leading-relaxed">
                    Ayo Rika! Jangan mau kalah sama Azka, cicil terus ya!
                </p>
            </div>
        </div>

        <!-- Checklist -->
        <div class="space-y-4">
            <div class="flex justify-between items-center px-2">
                <h2 class="font-black text-slate-800 flex items-center gap-2 text-lg uppercase tracking-tight">
                    <i data-lucide="list-checks" class="w-5 h-5 text-emerald-600"></i> Juz Tracker
                </h2>
                <button onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="text-[10px] font-bold text-emerald-600 uppercase">Back to Top</button>
            </div>
            
            <div id="juz-container" class="grid gap-3">
                <!-- Juz items injected by JS -->
            </div>
        </div>
    </main>

    <!-- Bottom Message Bar -->
    <div class="fixed bottom-0 left-0 right-0 p-4 glass border-t border-slate-200 z-50">
        <div class="max-w-md mx-auto flex items-center gap-3">
            <div class="flex-1 text-xs font-bold text-slate-500">
                Data tersinkron otomatis secara lokal.
            </div>
            <div class="flex gap-2">
                <button onclick="alert('Fitur Chat Cloud menyusul ya!')" class="bg-slate-100 text-slate-600 p-2.5 rounded-xl">
                    <i data-lucide="message-square" class="w-5 h-5"></i>
                </button>
                <button onclick="shareProgress()" class="bg-emerald-600 text-white px-5 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 shadow-lg shadow-emerald-200">
                    <i data-lucide="share-2" class="w-4 h-4"></i> Share
                </button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore-compat.js"></script>

    <script>
        // Data & Dates
        const RAMADHAN_START = new Date('2026-03-19T00:00:00');
        const EID_TARGET = new Date('2026-03-20T00:00:00');
        
        const QUOTES = [
            "Bacalah Al-Qur'an, karena ia akan datang pada hari kiamat sebagai syafaat.",
            "Setiap satu huruf Al-Qur'an adalah sepuluh kebaikan.",
            "Al-Qur'an adalah cahaya di bumi dan simpanan di langit.",
            "Ramadhan adalah bulan diturunkannya Al-Qur'an.",
            "Semangat Khatam! Rika & Azka pasti bisa!"
        ];

        let state = {
            rika: JSON.parse(localStorage.getItem('khatam_rika')) || {},
            azka: JSON.parse(localStorage.getItem('khatam_azka')) || {}
        };

        const SURAH_MAP = [
            "Al-Fatihah - Al-Baqarah 141", "Al-Baqarah 142 - 252", "Al-Baqarah 253 - Ali 'Imran 92",
            "Ali 'Imran 93 - An-Nisa 23", "An-Nisa 24 - 147", "An-Nisa 148 - Al-Ma'idah 81",
            "Al-Ma'idah 82 - Al-An'am 110", "Al-An'am 111 - Al-A'raf 87", "Al-A'raf 88 - Al-Anfal 40",
            "Al-Anfal 41 - At-Taubah 92", "At-Taubah 93 - Hud 5", "Hud 6 - Yusuf 52",
            "Yusuf 53 - Ibrahim 52", "Al-Hijr 1 - An-Nahl 128", "Al-Isra 1 - Al-Kahfi 74",
            "Al-Kahfi 75 - Ta Ha 135", "Al-Anbiya 1 - Al-Hajj 78", "Al-Mu'minun 1 - Al-Furqan 20",
            "Al-Furqan 21 - An-Naml 55", "An-Naml 56 - Al-'Ankabut 45", "Al-'Ankabut 46 - Al-Ahzab 30",
            "Al-Ahzab 31 - Yasin 27", "Yasin 28 - Az-Zumar 31", "Az-Zumar 32 - Fussilat 46",
            "Fussilat 47 - Al-Jathiyah 37", "Al-Ahqaf 1 - Adh-Dhariyat 30", "Adh-Dhariyat 31 - Al-Hadid 29",
            "Al-Mujadila 1 - At-Tahrim 12", "Al-Mulk 1 - Al-Mursalat 50", "An-Naba 1 - An-Nas 6"
        ];

        function updateCountdown() {
            const now = new Date();
            const distance = EID_TARGET.getTime() - now.getTime();
            const countdownEl = document.getElementById('countdown');
            
            if (distance > 0) {
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                countdownEl.innerHTML = `
                    <div class="bg-white/10 px-3 py-1.5 rounded-2xl text-center border border-white/20"><span class="text-base block leading-none">${days}</span><span class="text-[7px] opacity-60 uppercase">Hari</span></div>
                    <div class="bg-white/10 px-3 py-1.5 rounded-2xl text-center border border-white/20"><span class="text-base block leading-none">${hours}</span><span class="text-[7px] opacity-60 uppercase">Jam</span></div>
                `;
            }

            const diffTime = now.getTime() - RAMADHAN_START.getTime();
            let currentDay = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            currentDay = currentDay < 1 ? 1 : currentDay > 30 ? 30 : currentDay;
            
            document.getElementById('day-badge').innerText = `Ramadhan Day ${currentDay}`;
            document.getElementById('daily-quote').innerText = QUOTES[currentDay % QUOTES.length];
            return currentDay;
        }

        function toggleJuz(juzId, person) {
            state[person][juzId] = !state[person][juzId];
            localStorage.setItem(`khatam_${person}`, JSON.stringify(state[person]));
            
            // Play simple feedback
            if (state[person][juzId]) {
                confettiEffect();
            }
            
            render();
        }

        function confettiEffect() {
            // Placeholder for simple animation
            console.log("Juz Selesai! Alhamdulillah.");
        }

        function shareProgress() {
            const text = `Progress Khatam Ramadhan\nRika: ${document.getElementById('rika-count').innerText}/30\nAzka: ${document.getElementById('azka-count').innerText}/30\nSemangat Tadarus! ðŸŒ™`;
            if (navigator.share) {
                navigator.share({ title: 'Khatam Hub', text: text });
            } else {
                alert("Copied to clipboard!\n\n" + text);
            }
        }

        function updateStatus(rika, azka) {
            const title = document.getElementById('status-title');
            const desc = document.getElementById('status-desc');
            
            if (rika > azka) {
                title.innerText = "RIKA MEMIMPIN!";
                desc.innerText = "Azka, ayo kejar Rika! Jangan sampai ketinggalan jauh ya!";
            } else if (azka > rika) {
                title.innerText = "AZKA UNGGUL!";
                desc.innerText = "Rika semangat! Dikit lagi bisa nyalip Azka kok.";
            } else if (rika === 0 && azka === 0) {
                title.innerText = "SAMA-SAMA MULAI";
                desc.innerText = "Ayo mulai tadarus hari ini biar berkah Ramadhannya pol!";
            } else {
                title.innerText = "SKOR IMBANG!";
                desc.innerText = "Wah kalian kompak banget! Terus istiqomah bareng ya.";
            }
        }

        function render() {
            const container = document.getElementById('juz-container');
            const currentDay = updateCountdown();
            container.innerHTML = '';

            let rikaTotal = 0;
            let azkaTotal = 0;

            for (let i = 1; i <= 30; i++) {
                const doneRika = state.rika[i];
                const doneAzka = state.azka[i];
                if (doneRika) rikaTotal++;
                if (doneAzka) azkaTotal++;

                const isTarget = i === currentDay;
                const item = document.createElement('div');
                item.className = `bg-white p-5 rounded-[2rem] border-2 transition-all duration-300 flex items-center justify-between shadow-sm hover:shadow-md ${doneRika && doneAzka ? 'border-emerald-500 bg-emerald-50/20' : isTarget ? 'border-yellow-400 bg-yellow-50/30' : 'border-slate-50'}`;
                
                item.innerHTML = `
                    <div class="flex items-center gap-5">
                        <div class="relative">
                            <div class="w-12 h-12 rounded-2xl flex items-center justify-center font-black text-lg ${doneRika && doneAzka ? 'bg-emerald-600 text-white shadow-lg shadow-emerald-100' : isTarget ? 'bg-yellow-400 text-yellow-900 shadow-lg shadow-yellow-100' : 'bg-slate-100 text-slate-400'}">
                                ${i}
                            </div>
                            ${isTarget ? '<span class="absolute -top-2 -left-2 bg-red-500 text-white text-[7px] font-black px-1.5 py-0.5 rounded-full animate-bounce">NOW</span>' : ''}
                        </div>
                        <div>
                            <div class="text-xs font-black text-slate-800 flex items-center gap-1.5 uppercase tracking-tight">
                                JUZ ${i}
                            </div>
                            <div class="text-[10px] text-slate-400 font-bold uppercase truncate max-w-[140px]">
                                ${SURAH_MAP[i-1]}
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-4">
                        <button onclick="toggleJuz(${i}, 'rika')" class="flex flex-col items-center gap-1.5 group">
                            <div class="p-2.5 rounded-2xl transition-all group-active:scale-90 ${doneRika ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-50 text-slate-200'}">
                                <i data-lucide="${doneRika ? 'check-circle' : 'circle'}" class="w-5 h-5"></i>
                            </div>
                            <span class="text-[8px] font-black text-slate-400 uppercase">Rika</span>
                        </button>
                        <button onclick="toggleJuz(${i}, 'azka')" class="flex flex-col items-center gap-1.5 group">
                            <div class="p-2.5 rounded-2xl transition-all group-active:scale-90 ${doneAzka ? 'bg-blue-100 text-blue-600' : 'bg-slate-50 text-slate-200'}">
                                <i data-lucide="${doneAzka ? 'check-circle' : 'circle'}" class="w-5 h-5"></i>
                            </div>
                            <span class="text-[8px] font-black text-slate-400 uppercase">Azka</span>
                        </button>
                    </div>
                `;
                container.appendChild(item);
            }

            // Update UI
            document.getElementById('rika-count').innerText = rikaTotal;
            document.getElementById('azka-count').innerText = azkaTotal;
            document.getElementById('rika-bar').style.width = `${(rikaTotal/30)*100}%`;
            document.getElementById('azka-bar').style.width = `${(azkaTotal/30)*100}%`;
            
            updateStatus(rikaTotal, azkaTotal);
            lucide.createIcons();
        }

        window.onload = render;
        setInterval(updateCountdown, 60000);
    </script>
</body>
</html>